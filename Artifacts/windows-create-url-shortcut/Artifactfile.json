{
  "$schema": "https://raw.githubusercontent.com/Azure/azure-devtestlab/master/schemas/2015-01-01/dtlArtifacts.json",
  "title": "Create a url shortcut",
  "description": "Creates a web shortcut to an internet or intranet resource.",
  "tags": [
    "Windows",
    "Url",
    "Shortcut"
  ],
  "iconUri": "",
  "targetOsType": "Windows",
  "parameters": {
    "ShortcutName": {
      "type": "string",
      "displayName": "Shortcut Name",
      "description": "The name to assign to the shortcut file.",
      "defaultValue": "Azure Portal - Shortcut"
    },
    "ShortcutFolder": {
      "type": "string",
      "displayName": "Shortcut Folder",
      "description": "The folder in which the shortcut file will be created.",
      "defaultValue": "c:\\users\\public\\desktop"
    },
    "ShortcutTargetPath": {
      "type": "string",
      "displayName": "Shortcut Target",
      "description": "The intranet or internet resource that'll be invoked by this shortcut.",
      "defaultValue": "http://portal.azure.com"
    }
  },
  "runCommand": {
    "commandToExecute": "[concat('powershell.exe -executionpolicy bypass -File CreateUrlShortcut.ps1', ' -ShortcutName \"', parameters('ShortcutName'), '\" -ShortcutFolder \"', parameters('ShortcutFolder'), '\" -ShortcutTargetPath \"', parameters('ShortcutTargetPath'), '\"')]"
  }
}
